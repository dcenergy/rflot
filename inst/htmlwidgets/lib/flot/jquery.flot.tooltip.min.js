(function(b){var a={tooltip:false,tooltipOpts:{id:"flotTip",content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:true,lines:false,onHover:function(f,e){},$compat:false}};var c=function(e){this.tipPosition={x:0,y:0};this.init(e)};c.prototype.init=function(i){var f=this;var g=b.plot.plugins.length;this.plotPlugins=[];if(g){for(var h=0;h<g;h++){this.plotPlugins.push(b.plot.plugins[h].name)}}i.hooks.bindEvents.push(function(l,k){f.plotOptions=l.getOptions();if(f.plotOptions.tooltip===false||typeof f.plotOptions.tooltip==="undefined"){return}f.tooltipOptions=f.plotOptions.tooltipOpts;if(f.tooltipOptions.$compat){f.wfunc="width";f.hfunc="height"}else{f.wfunc="innerWidth";f.hfunc="innerHeight"}var m=f.getDomElement();b(l.getPlaceholder()).bind("plothover",j);b(k).bind("mousemove",e)});i.hooks.shutdown.push(function(l,k){b(l.getPlaceholder()).unbind("plothover",j);b(k).unbind("mousemove",e)});function e(k){var l={};l.x=k.pageX;l.y=k.pageY;i.setTooltipPosition(l)}function j(n,q,m){var k=function(s,r,u,t){return Math.sqrt((u-s)*(u-s)+(t-r)*(t-r))};var l=function(D,A,t,E,r,C,s){if(s&&!(s=function(F,M,H,J,G,I){if(typeof H!=="undefined"){return{x:H,y:M}}else{if(typeof J!=="undefined"){return{x:F,y:J}}}var L,K=-1/((I-J)/(G-H));return{x:L=(G*(F*K-M+J)+H*(F*-K+M-I))/(K*(G-H)+J-I),y:K*L-K*F+M}}(D,A,t,E,r,C),s.x>=Math.min(t,r)&&s.x<=Math.max(t,r)&&s.y>=Math.min(E,C)&&s.y<=Math.max(E,C))){var v=k(D,A,t,E),u=k(D,A,r,C);return v>u?u:v}else{var B=E-C,z=r-t,w=t*C-E*r;return Math.abs(B*D+z*A+w)/Math.sqrt(B*B+z*z)}};if(m){i.showTooltip(m,q)}else{if(f.plotOptions.series.lines.show&&f.tooltipOptions.lines===true){var p=f.plotOptions.grid.mouseActiveRadius;var o={distance:p+1};b.each(i.getData(),function(u,v){var y=0,x=-1;for(var s=1;s<v.data.length;s++){if(v.data[s-1][0]<=q.x&&v.data[s][0]>=q.x){y=s-1;x=s}}if(x===-1){i.hideTooltip();return}var w={x:v.data[y][0],y:v.data[y][1]},A={x:v.data[x][0],y:v.data[x][1]};var r=l(v.xaxis.p2c(q.x),v.yaxis.p2c(q.y),v.xaxis.p2c(w.x),v.yaxis.p2c(w.y),v.xaxis.p2c(A.x),v.yaxis.p2c(A.y),false);if(r<o.distance){var z=k(w.x,w.y,q.x,q.y)<k(q.x,q.y,A.x,A.y)?y:x;var t=v.datapoints.pointsize;var C=[q.x,w.y+((A.y-w.y)*((q.x-w.x)/(A.x-w.x)))];var B={datapoint:C,dataIndex:z,series:v,seriesIndex:u};o={distance:r,item:B}}});if(o.distance<p+1){i.showTooltip(o.item,q)}else{i.hideTooltip()}}else{i.hideTooltip()}}}i.setTooltipPosition=function(n){var m=f.getDomElement();var k=m.outerWidth()+f.tooltipOptions.shifts.x;var l=m.outerHeight()+f.tooltipOptions.shifts.y;if((n.x-b(window).scrollLeft())>(b(window)[f.wfunc]()-k)){n.x-=k}if((n.y-b(window).scrollTop())>(b(window)[f.hfunc]()-l)){n.y-=l}f.tipPosition.x=n.x;f.tipPosition.y=n.y};i.showTooltip=function(m,k){var n=f.getDomElement();var l=f.stringFormat(f.tooltipOptions.content,m);n.html(l);i.setTooltipPosition({x:k.pageX,y:k.pageY});n.css({left:f.tipPosition.x+f.tooltipOptions.shifts.x,top:f.tipPosition.y+f.tooltipOptions.shifts.y}).show();if(typeof f.tooltipOptions.onHover==="function"){f.tooltipOptions.onHover(m,n)}};i.hideTooltip=function(){f.getDomElement().hide().html("")}};c.prototype.getDomElement=function(){var e=b("#"+this.tooltipOptions.id);if(e.length===0){e=b("<div />").attr("id",this.tooltipOptions.id);e.appendTo("body").hide().css({position:"absolute"});if(this.tooltipOptions.defaultTheme){e.css({background:"#fff","z-index":"1040",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"})}}return e};c.prototype.stringFormat=function(s,v){var h=/%p\.{0,1}(\d{0,})/;var m=/%s/;var f=/%lx/;var w=/%ly/;var t=/%x\.{0,1}(\d{0,})/;var g=/%y\.{0,1}(\d{0,})/;var k="%x";var A="%y";var u="%ct";var n,l,j,o;if(typeof v.series.threshold!=="undefined"){n=v.datapoint[0];l=v.datapoint[1];j=v.datapoint[2]}else{if(typeof v.series.lines!=="undefined"&&v.series.lines.steps){n=v.series.datapoints.points[v.dataIndex*2];l=v.series.datapoints.points[v.dataIndex*2+1];j=""}else{n=v.series.data[v.dataIndex][0];l=v.series.data[v.dataIndex][1];j=v.series.data[v.dataIndex][2]}}if(v.series.label===null&&v.series.originSeries){v.series.label=v.series.originSeries.label}if(typeof(s)==="function"){s=s(v.series.label,n,l,v)}if(typeof(v.series.percent)!=="undefined"){o=v.series.percent}else{if(typeof(v.series.percents)!=="undefined"){o=v.series.percents[v.dataIndex]}}if(typeof o==="number"){s=this.adjustValPrecision(h,s,o)}if(typeof(v.series.label)!=="undefined"){s=s.replace(m,v.series.label)}else{s=s.replace(m,"")}if(this.hasAxisLabel("xaxis",v)){s=s.replace(f,v.series.xaxis.options.axisLabel)}else{s=s.replace(f,"")}if(this.hasAxisLabel("yaxis",v)){s=s.replace(w,v.series.yaxis.options.axisLabel)}else{s=s.replace(w,"")}if(this.isTimeMode("xaxis",v)&&this.isXDateFormat(v)){s=s.replace(t,this.timestampToDate(n,this.tooltipOptions.xDateFormat,v.series.xaxis.options))}if(this.isTimeMode("yaxis",v)&&this.isYDateFormat(v)){s=s.replace(g,this.timestampToDate(l,this.tooltipOptions.yDateFormat,v.series.yaxis.options))}if(typeof n==="number"){s=this.adjustValPrecision(t,s,n)}if(typeof l==="number"){s=this.adjustValPrecision(g,s,l)}if(typeof v.series.xaxis.ticks!=="undefined"){var z;if(this.hasRotatedXAxisTicks(v)){z="rotatedTicks"}else{z="ticks"}var e=v.dataIndex+v.seriesIndex;if(v.series.xaxis[z].length>e&&!this.isTimeMode("xaxis",v)){var r=(this.isCategoriesMode("xaxis",v))?v.series.xaxis[z][e].label:v.series.xaxis[z][e].v;if(r===n){s=s.replace(t,v.series.xaxis[z][e].label)}}}if(typeof v.series.yaxis.ticks!=="undefined"){for(var i in v.series.yaxis.ticks){if(v.series.yaxis.ticks.hasOwnProperty(i)){var q=(this.isCategoriesMode("yaxis",v))?v.series.yaxis.ticks[i].label:v.series.yaxis.ticks[i].v;if(q===l){s=s.replace(g,v.series.yaxis.ticks[i].label)}}}}if(typeof v.series.xaxis.tickFormatter!=="undefined"){s=s.replace(k,v.series.xaxis.tickFormatter(n,v.series.xaxis).replace(/\$/g,"$$"))}if(typeof v.series.yaxis.tickFormatter!=="undefined"){s=s.replace(A,v.series.yaxis.tickFormatter(l,v.series.yaxis).replace(/\$/g,"$$"))}if(j){s=s.replace(u,j)}return s};c.prototype.isTimeMode=function(f,e){return(typeof e.series[f].options.mode!=="undefined"&&e.series[f].options.mode==="time")};c.prototype.isXDateFormat=function(e){return(typeof this.tooltipOptions.xDateFormat!=="undefined"&&this.tooltipOptions.xDateFormat!==null)};c.prototype.isYDateFormat=function(e){return(typeof this.tooltipOptions.yDateFormat!=="undefined"&&this.tooltipOptions.yDateFormat!==null)};c.prototype.isCategoriesMode=function(f,e){return(typeof e.series[f].options.mode!=="undefined"&&e.series[f].options.mode==="categories")};c.prototype.timestampToDate=function(f,e,g){var h=b.plot.dateGenerator(f,g);return b.plot.formatDate(h,e,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)};c.prototype.adjustValPrecision=function(i,g,h){var f;var e=g.match(i);if(e!==null){if(RegExp.$1!==""){f=RegExp.$1;h=h.toFixed(f);g=g.replace(i,h)}}return g};c.prototype.hasAxisLabel=function(f,e){return(b.inArray(this.plotPlugins,"axisLabels")!==-1&&typeof e.series[f].options.axisLabel!=="undefined"&&e.series[f].options.axisLabel.length>0)};c.prototype.hasRotatedXAxisTicks=function(e){return(b.inArray(this.plotPlugins,"tickRotor")!==-1&&typeof e.series.xaxis.rotatedTicks!=="undefined")};var d=function(e){new c(e)};b.plot.plugins.push({init:d,options:a,name:"tooltip",version:"0.8.4"})})(jQuery);